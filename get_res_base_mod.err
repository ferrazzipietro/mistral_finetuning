/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/huggingface_hub/utils/_runtime.py:184: UserWarning: Pydantic is installed but cannot be imported. Please check your installation. `huggingface_hub` will default to not using Pydantic. Error message: '{e}'
  warnings.warn(
Map:   0%|          | 0/1520 [00:00<?, ? examples/s]Map:  12%|█▏        | 176/1520 [00:00<00:00, 1383.18 examples/s]Map:  36%|███▌      | 550/1520 [00:00<00:00, 2622.24 examples/s]Map:  61%|██████    | 921/1520 [00:00<00:00, 3085.50 examples/s]Map:  91%|█████████▏| 1390/1520 [00:00<00:00, 2525.29 examples/s]Map: 100%|██████████| 1520/1520 [00:00<00:00, 2248.58 examples/s]
Map:   0%|          | 0/170 [00:00<?, ? examples/s]Map: 100%|██████████| 170/170 [00:00<00:00, 1697.47 examples/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:29<00:59, 29.90s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:01<00:30, 30.83s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:20<00:00, 25.65s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:20<00:00, 26.96s/it]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map:  70%|███████   | 478/681 [00:00<00:00, 4649.96 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 2725.62 examples/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 5015.22 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 4478.92 examples/s]
generating responses:   0%|          | 0/681 [00:00<?, ?it/s]2024-02-26 10:47:33.696827: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-02-26 10:47:35.623820: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-26 10:47:41.266100: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
generating responses:   2%|▏         | 12/681 [00:52<48:46,  4.37s/it]generating responses:   4%|▎         | 24/681 [01:23<36:29,  3.33s/it]generating responses:   5%|▌         | 36/681 [01:53<31:32,  2.93s/it]generating responses:   7%|▋         | 48/681 [02:22<29:03,  2.75s/it]generating responses:   9%|▉         | 60/681 [02:52<27:26,  2.65s/it]generating responses:  11%|█         | 72/681 [03:22<26:19,  2.59s/it]generating responses:  12%|█▏        | 84/681 [03:52<25:30,  2.56s/it]generating responses:  14%|█▍        | 96/681 [04:22<24:49,  2.55s/it]generating responses:  16%|█▌        | 108/681 [04:52<24:06,  2.52s/it]generating responses:  18%|█▊        | 120/681 [05:22<23:35,  2.52s/it]generating responses:  19%|█▉        | 132/681 [05:56<23:55,  2.61s/it]generating responses:  21%|██        | 144/681 [06:30<24:00,  2.68s/it]generating responses:  23%|██▎       | 156/681 [07:04<23:50,  2.72s/it]generating responses:  25%|██▍       | 168/681 [07:38<23:31,  2.75s/it]generating responses:  26%|██▋       | 180/681 [08:11<23:08,  2.77s/it]generating responses:  28%|██▊       | 192/681 [08:45<22:40,  2.78s/it]generating responses:  30%|██▉       | 204/681 [09:19<22:17,  2.80s/it]generating responses:  32%|███▏      | 216/681 [09:54<21:56,  2.83s/it]generating responses:  33%|███▎      | 228/681 [10:28<21:19,  2.82s/it]generating responses:  35%|███▌      | 240/681 [11:01<20:43,  2.82s/it]generating responses:  37%|███▋      | 252/681 [11:35<20:11,  2.83s/it]generating responses:  39%|███▉      | 264/681 [12:09<19:38,  2.83s/it]generating responses:  41%|████      | 276/681 [12:43<19:06,  2.83s/it]generating responses:  42%|████▏     | 288/681 [13:17<18:31,  2.83s/it]generating responses:  44%|████▍     | 300/681 [13:51<17:56,  2.83s/it]generating responses:  46%|████▌     | 312/681 [14:25<17:21,  2.82s/it]generating responses:  48%|████▊     | 324/681 [14:59<16:47,  2.82s/it]generating responses:  49%|████▉     | 336/681 [15:33<16:13,  2.82s/it]generating responses:  51%|█████     | 348/681 [16:07<15:39,  2.82s/it]generating responses:  53%|█████▎    | 360/681 [16:40<15:06,  2.82s/it]generating responses:  55%|█████▍    | 372/681 [17:14<14:33,  2.83s/it]generating responses:  56%|█████▋    | 384/681 [17:48<13:57,  2.82s/it]generating responses:  58%|█████▊    | 396/681 [18:22<13:23,  2.82s/it]generating responses:  60%|█████▉    | 408/681 [18:56<12:48,  2.82s/it]generating responses:  62%|██████▏   | 420/681 [19:30<12:16,  2.82s/it]generating responses:  63%|██████▎   | 432/681 [20:03<11:41,  2.82s/it]generating responses:  65%|██████▌   | 444/681 [20:37<11:06,  2.81s/it]generating responses:  67%|██████▋   | 456/681 [21:11<10:32,  2.81s/it]generating responses:  69%|██████▊   | 468/681 [21:44<09:58,  2.81s/it]generating responses:  70%|███████   | 480/681 [22:15<09:11,  2.74s/it]generating responses:  72%|███████▏  | 492/681 [22:45<08:25,  2.67s/it]generating responses:  74%|███████▍  | 504/681 [23:15<07:43,  2.62s/it]generating responses:  76%|███████▌  | 516/681 [23:45<07:06,  2.58s/it]generating responses:  78%|███████▊  | 528/681 [24:15<06:30,  2.55s/it]generating responses:  79%|███████▉  | 540/681 [24:45<05:57,  2.54s/it]generating responses:  81%|████████  | 552/681 [25:15<05:24,  2.52s/it]generating responses:  83%|████████▎ | 564/681 [25:45<04:54,  2.52s/it]generating responses:  85%|████████▍ | 576/681 [26:15<04:24,  2.52s/it]generating responses:  86%|████████▋ | 588/681 [26:45<03:53,  2.51s/it]generating responses:  88%|████████▊ | 600/681 [27:15<03:23,  2.51s/it]generating responses:  90%|████████▉ | 612/681 [27:45<02:53,  2.51s/it]generating responses:  92%|█████████▏| 624/681 [28:16<02:24,  2.53s/it]generating responses:  93%|█████████▎| 636/681 [28:47<01:53,  2.53s/it]generating responses:  95%|█████████▌| 648/681 [29:17<01:23,  2.52s/it]generating responses:  97%|█████████▋| 660/681 [29:47<00:52,  2.51s/it]generating responses:  99%|█████████▊| 672/681 [30:17<00:22,  2.53s/it]generating responses: 684it [30:46,  2.49s/it]                         generating responses: 684it [30:46,  2.70s/it]
Creating CSV from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating CSV from Arrow format: 100%|██████████| 1/1 [00:00<00:00,  2.08ba/s]Creating CSV from Arrow format: 100%|██████████| 1/1 [00:00<00:00,  2.08ba/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map:  78%|███████▊  | 531/681 [00:00<00:00, 5182.24 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 3511.09 examples/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 5444.41 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 4780.20 examples/s]
generating responses:   0%|          | 0/681 [00:00<?, ?it/s]generating responses:   2%|▏         | 12/681 [00:16<14:57,  1.34s/it]generating responses:   4%|▎         | 24/681 [00:42<20:02,  1.83s/it]generating responses:   5%|▌         | 36/681 [00:54<15:47,  1.47s/it]generating responses:   7%|▋         | 48/681 [01:09<14:23,  1.36s/it]generating responses:   9%|▉         | 60/681 [01:24<13:48,  1.33s/it]generating responses:  11%|█         | 72/681 [01:46<15:19,  1.51s/it]generating responses:  12%|█▏        | 84/681 [02:04<15:00,  1.51s/it]generating responses:  14%|█▍        | 96/681 [02:24<15:15,  1.56s/it]generating responses:  16%|█▌        | 108/681 [02:46<15:41,  1.64s/it]generating responses:  18%|█▊        | 120/681 [03:17<18:04,  1.93s/it]generating responses:  19%|█▉        | 132/681 [03:35<16:24,  1.79s/it]generating responses:  21%|██        | 144/681 [04:07<18:19,  2.05s/it]generating responses:  23%|██▎       | 156/681 [04:23<16:09,  1.85s/it]generating responses:  25%|██▍       | 168/681 [04:35<13:33,  1.59s/it]generating responses:  26%|██▋       | 180/681 [04:54<13:11,  1.58s/it]generating responses:  28%|██▊       | 192/681 [05:11<12:28,  1.53s/it]generating responses:  30%|██▉       | 204/681 [05:31<12:27,  1.57s/it]generating responses:  32%|███▏      | 216/681 [06:02<14:40,  1.89s/it]generating responses:  33%|███▎      | 228/681 [06:17<12:45,  1.69s/it]generating responses:  35%|███▌      | 240/681 [06:30<11:01,  1.50s/it]generating responses:  37%|███▋      | 252/681 [06:57<12:20,  1.73s/it]generating responses:  39%|███▉      | 264/681 [07:28<13:51,  1.99s/it]generating responses:  41%|████      | 276/681 [07:51<13:13,  1.96s/it]generating responses:  42%|████▏     | 288/681 [08:05<11:18,  1.73s/it]generating responses:  44%|████▍     | 300/681 [08:24<10:39,  1.68s/it]generating responses:  46%|████▌     | 312/681 [08:42<10:05,  1.64s/it]generating responses:  48%|████▊     | 324/681 [09:09<10:49,  1.82s/it]generating responses:  49%|████▉     | 336/681 [09:41<11:50,  2.06s/it]generating responses:  51%|█████     | 348/681 [10:05<11:25,  2.06s/it]generating responses:  53%|█████▎    | 360/681 [10:31<11:11,  2.09s/it]generating responses:  55%|█████▍    | 372/681 [11:03<11:36,  2.25s/it]generating responses:  56%|█████▋    | 384/681 [11:32<11:22,  2.30s/it]generating responses:  58%|█████▊    | 396/681 [11:54<10:17,  2.17s/it]generating responses:  60%|█████▉    | 408/681 [12:24<10:19,  2.27s/it]generating responses:  62%|██████▏   | 420/681 [12:52<09:57,  2.29s/it]generating responses:  63%|██████▎   | 432/681 [13:18<09:23,  2.26s/it]generating responses:  65%|██████▌   | 444/681 [13:50<09:19,  2.36s/it]generating responses:  67%|██████▋   | 456/681 [14:08<07:53,  2.10s/it]generating responses:  69%|██████▊   | 468/681 [14:27<06:56,  1.95s/it]generating responses:  70%|███████   | 480/681 [14:53<06:43,  2.01s/it]generating responses:  72%|███████▏  | 492/681 [15:07<05:32,  1.76s/it]generating responses:  74%|███████▍  | 504/681 [15:33<05:33,  1.88s/it]generating responses:  76%|███████▌  | 516/681 [15:50<04:47,  1.74s/it]generating responses:  78%|███████▊  | 528/681 [16:10<04:25,  1.74s/it]generating responses:  79%|███████▉  | 540/681 [16:28<03:52,  1.65s/it]generating responses:  81%|████████  | 552/681 [16:39<03:05,  1.44s/it]generating responses:  83%|████████▎ | 564/681 [16:54<02:41,  1.38s/it]generating responses:  85%|████████▍ | 576/681 [17:18<02:42,  1.55s/it]generating responses:  86%|████████▋ | 588/681 [17:28<02:05,  1.35s/it]generating responses:  88%|████████▊ | 600/681 [17:46<01:53,  1.40s/it]generating responses:  90%|████████▉ | 612/681 [18:02<01:34,  1.37s/it]generating responses:  92%|█████████▏| 624/681 [18:34<01:40,  1.76s/it]generating responses:  93%|█████████▎| 636/681 [19:05<01:30,  2.02s/it]generating responses:  95%|█████████▌| 648/681 [19:25<01:02,  1.89s/it]generating responses:  97%|█████████▋| 660/681 [19:36<00:33,  1.62s/it]generating responses:  99%|█████████▊| 672/681 [20:06<00:16,  1.87s/it]generating responses: 684it [20:13,  1.50s/it]                         generating responses: 684it [20:13,  1.77s/it]
Creating CSV from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating CSV from Arrow format: 100%|██████████| 1/1 [00:00<00:00,  2.40ba/s]Creating CSV from Arrow format: 100%|██████████| 1/1 [00:00<00:00,  2.40ba/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map:  82%|████████▏ | 560/681 [00:00<00:00, 5465.93 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 3556.67 examples/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 5099.58 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 4480.86 examples/s]
generating responses:   0%|          | 0/681 [00:00<?, ?it/s]generating responses:   2%|▏         | 12/681 [00:15<14:01,  1.26s/it]generating responses:   4%|▎         | 24/681 [00:31<14:21,  1.31s/it]generating responses:   5%|▌         | 36/681 [00:41<11:58,  1.11s/it]generating responses:   7%|▋         | 48/681 [01:00<13:46,  1.30s/it]generating responses:   9%|▉         | 60/681 [01:15<13:16,  1.28s/it]generating responses:  11%|█         | 72/681 [01:33<13:36,  1.34s/it]generating responses:  12%|█▏        | 84/681 [01:48<13:00,  1.31s/it]generating responses:  14%|█▍        | 96/681 [02:03<12:44,  1.31s/it]generating responses:  16%|█▌        | 108/681 [02:16<11:48,  1.24s/it]generating responses:  18%|█▊        | 120/681 [02:50<15:58,  1.71s/it]generating responses:  19%|█▉        | 132/681 [03:06<14:44,  1.61s/it]generating responses:  21%|██        | 144/681 [03:39<17:33,  1.96s/it]generating responses:  23%|██▎       | 156/681 [03:56<15:31,  1.77s/it]generating responses:  25%|██▍       | 168/681 [04:24<16:38,  1.95s/it]generating responses:  26%|██▋       | 180/681 [04:44<15:34,  1.86s/it]generating responses:  28%|██▊       | 192/681 [04:55<12:52,  1.58s/it]generating responses:  30%|██▉       | 204/681 [05:20<13:43,  1.73s/it]generating responses:  32%|███▏      | 216/681 [05:55<16:10,  2.09s/it]generating responses:  33%|███▎      | 228/681 [06:09<13:40,  1.81s/it]generating responses:  35%|███▌      | 240/681 [06:29<13:02,  1.77s/it]generating responses:  37%|███▋      | 252/681 [06:51<12:46,  1.79s/it]generating responses:  39%|███▉      | 264/681 [07:26<14:45,  2.12s/it]generating responses:  41%|████      | 276/681 [07:48<13:48,  2.05s/it]generating responses:  42%|████▏     | 288/681 [08:03<11:50,  1.81s/it]generating responses:  44%|████▍     | 300/681 [08:24<11:17,  1.78s/it]generating responses:  46%|████▌     | 312/681 [08:43<10:41,  1.74s/it]generating responses:  48%|████▊     | 324/681 [09:06<10:35,  1.78s/it]generating responses:  49%|████▉     | 336/681 [09:30<10:39,  1.85s/it]generating responses:  51%|█████     | 348/681 [09:56<10:49,  1.95s/it]generating responses:  53%|█████▎    | 360/681 [10:12<09:25,  1.76s/it]generating responses:  55%|█████▍    | 372/681 [10:45<10:37,  2.06s/it]generating responses:  56%|█████▋    | 384/681 [11:16<10:54,  2.20s/it]generating responses:  58%|█████▊    | 396/681 [11:34<09:31,  2.00s/it]generating responses:  60%|█████▉    | 408/681 [11:50<08:10,  1.80s/it]generating responses:  62%|██████▏   | 420/681 [12:14<08:05,  1.86s/it]generating responses:  63%|██████▎   | 432/681 [12:28<06:50,  1.65s/it]generating responses:  65%|██████▌   | 444/681 [12:46<06:23,  1.62s/it]generating responses:  67%|██████▋   | 456/681 [12:58<05:20,  1.42s/it]generating responses:  69%|██████▊   | 468/681 [13:20<05:28,  1.54s/it]generating responses:  70%|███████   | 480/681 [13:51<06:12,  1.85s/it]generating responses:  72%|███████▏  | 492/681 [14:02<04:56,  1.57s/it]generating responses:  74%|███████▍  | 504/681 [14:17<04:21,  1.48s/it]generating responses:  76%|███████▌  | 516/681 [14:30<03:44,  1.36s/it]generating responses:  78%|███████▊  | 528/681 [14:46<03:25,  1.34s/it]generating responses:  79%|███████▉  | 540/681 [15:04<03:16,  1.39s/it]generating responses:  81%|████████  | 552/681 [15:14<02:39,  1.23s/it]generating responses:  83%|████████▎ | 564/681 [15:33<02:35,  1.33s/it]generating responses:  85%|████████▍ | 576/681 [15:56<02:37,  1.50s/it]generating responses:  86%|████████▋ | 588/681 [16:05<01:58,  1.28s/it]generating responses:  88%|████████▊ | 600/681 [16:20<01:44,  1.29s/it]generating responses:  90%|████████▉ | 612/681 [16:35<01:27,  1.27s/it]generating responses:  92%|█████████▏| 624/681 [17:09<01:38,  1.73s/it]generating responses:  93%|█████████▎| 636/681 [17:42<01:31,  2.04s/it]generating responses:  95%|█████████▌| 648/681 [18:04<01:04,  1.97s/it]generating responses:  97%|█████████▋| 660/681 [18:16<00:35,  1.69s/it]generating responses:  99%|█████████▊| 672/681 [18:41<00:16,  1.80s/it]generating responses: 684it [18:49,  1.47s/it]                         generating responses: 684it [18:49,  1.65s/it]
Creating CSV from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating CSV from Arrow format: 100%|██████████| 1/1 [00:00<00:00,  2.27ba/s]Creating CSV from Arrow format: 100%|██████████| 1/1 [00:00<00:00,  2.27ba/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map:  72%|███████▏  | 487/681 [00:00<00:00, 4755.51 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 3299.66 examples/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 5292.96 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 4651.71 examples/s]
generating responses:   0%|          | 0/681 [00:00<?, ?it/s]generating responses:   2%|▏         | 12/681 [00:16<15:38,  1.40s/it]generating responses:   4%|▎         | 24/681 [00:33<15:04,  1.38s/it]generating responses:   5%|▌         | 36/681 [00:50<15:20,  1.43s/it]generating responses:   7%|▋         | 48/681 [01:10<16:00,  1.52s/it]generating responses:   9%|▉         | 60/681 [01:30<16:16,  1.57s/it]generating responses:  11%|█         | 72/681 [01:54<17:11,  1.69s/it]generating responses:  12%|█▏        | 84/681 [02:13<16:40,  1.68s/it]generating responses:  14%|█▍        | 96/681 [02:33<16:14,  1.67s/it]generating responses:  16%|█▌        | 108/681 [02:48<14:39,  1.54s/it]generating responses:  18%|█▊        | 120/681 [03:18<17:09,  1.83s/it]generating responses:  19%|█▉        | 132/681 [03:36<15:49,  1.73s/it]generating responses:  21%|██        | 144/681 [04:10<18:30,  2.07s/it]generating responses:  23%|██▎       | 156/681 [04:42<19:36,  2.24s/it]generating responses:  25%|██▍       | 168/681 [05:02<17:50,  2.09s/it]generating responses:  26%|██▋       | 180/681 [05:23<16:31,  1.98s/it]generating responses:  28%|██▊       | 192/681 [05:41<14:51,  1.82s/it]generating responses:  30%|██▉       | 204/681 [06:05<15:02,  1.89s/it]generating responses:  32%|███▏      | 216/681 [06:40<16:55,  2.18s/it]generating responses:  33%|███▎      | 228/681 [06:54<14:18,  1.90s/it]generating responses:  35%|███▌      | 240/681 [07:18<14:08,  1.92s/it]generating responses:  37%|███▋      | 252/681 [07:42<13:55,  1.95s/it]generating responses:  39%|███▉      | 264/681 [08:16<15:22,  2.21s/it]generating responses:  41%|████      | 276/681 [08:37<13:59,  2.07s/it]generating responses:  42%|████▏     | 288/681 [08:57<12:48,  1.96s/it]generating responses:  44%|████▍     | 300/681 [09:24<12:50,  2.02s/it]generating responses:  46%|████▌     | 312/681 [09:46<12:09,  1.98s/it]generating responses:  48%|████▊     | 324/681 [10:10<11:43,  1.97s/it]generating responses:  49%|████▉     | 336/681 [10:38<12:04,  2.10s/it]generating responses:  51%|█████     | 348/681 [11:04<11:43,  2.11s/it]generating responses:  53%|█████▎    | 360/681 [11:23<10:24,  1.95s/it]generating responses:  55%|█████▍    | 372/681 [11:57<11:24,  2.21s/it]generating responses:  56%|█████▋    | 384/681 [12:17<10:12,  2.06s/it]generating responses:  58%|█████▊    | 396/681 [12:40<09:34,  2.01s/it]generating responses:  60%|█████▉    | 408/681 [12:59<08:32,  1.88s/it]generating responses:  62%|██████▏   | 420/681 [13:24<08:24,  1.93s/it]generating responses:  63%|██████▎   | 432/681 [13:50<08:22,  2.02s/it]generating responses:  65%|██████▌   | 444/681 [14:24<08:53,  2.25s/it]generating responses:  67%|██████▋   | 456/681 [14:44<07:49,  2.08s/it]generating responses:  69%|██████▊   | 468/681 [15:05<07:03,  1.99s/it]generating responses:  70%|███████   | 480/681 [15:30<06:44,  2.01s/it]generating responses:  72%|███████▏  | 492/681 [15:47<05:46,  1.83s/it]generating responses:  74%|███████▍  | 504/681 [16:04<05:01,  1.70s/it]generating responses:  76%|███████▌  | 516/681 [16:22<04:32,  1.65s/it]generating responses:  78%|███████▊  | 528/681 [16:36<03:48,  1.49s/it]generating responses:  79%|███████▉  | 540/681 [16:55<03:35,  1.53s/it]generating responses:  81%|████████  | 552/681 [17:09<03:03,  1.42s/it]generating responses:  83%|████████▎ | 564/681 [17:26<02:45,  1.42s/it]generating responses:  85%|████████▍ | 576/681 [17:51<02:51,  1.63s/it]generating responses:  86%|████████▋ | 588/681 [18:04<02:14,  1.45s/it]generating responses:  88%|████████▊ | 600/681 [18:22<01:59,  1.47s/it]generating responses:  90%|████████▉ | 612/681 [18:38<01:38,  1.43s/it]generating responses:  92%|█████████▏| 624/681 [19:00<01:28,  1.56s/it]generating responses:  93%|█████████▎| 636/681 [19:35<01:27,  1.94s/it]generating responses:  95%|█████████▌| 648/681 [19:59<01:05,  1.97s/it]generating responses:  97%|█████████▋| 660/681 [20:16<00:38,  1.81s/it]generating responses:  99%|█████████▊| 672/681 [20:42<00:17,  1.91s/it]generating responses: 684it [20:52,  1.59s/it]                         generating responses: 684it [20:52,  1.83s/it]
Creating CSV from Arrow format:   0%|          | 0/1 [00:00<?, ?ba/s]Creating CSV from Arrow format: 100%|██████████| 1/1 [00:00<00:00,  2.22ba/s]Creating CSV from Arrow format: 100%|██████████| 1/1 [00:00<00:00,  2.22ba/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map:  66%|██████▌   | 449/681 [00:00<00:00, 4381.24 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 3150.11 examples/s]
Map:   0%|          | 0/681 [00:00<?, ? examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 5211.30 examples/s]Map: 100%|██████████| 681/681 [00:00<00:00, 4619.39 examples/s]
generating responses:   0%|          | 0/681 [00:00<?, ?it/s]generating responses:   2%|▏         | 12/681 [00:23<22:13,  1.99s/it]generating responses:   4%|▎         | 24/681 [00:43<19:20,  1.77s/it]generating responses:   5%|▌         | 36/681 [01:07<20:16,  1.89s/it]generating responses:   7%|▋         | 48/681 [01:31<20:18,  1.92s/it]generating responses:   9%|▉         | 60/681 [01:49<18:24,  1.78s/it]generating responses:  11%|█         | 72/681 [02:13<18:56,  1.87s/it]generating responses:  12%|█▏        | 84/681 [02:38<19:08,  1.92s/it]generating responses:  14%|█▍        | 96/681 [03:04<19:36,  2.01s/it]generating responses:  16%|█▌        | 108/681 [03:27<18:48,  1.97s/it]generating responses:  18%|█▊        | 120/681 [04:02<21:14,  2.27s/it]generating responses:  19%|█▉        | 132/681 [04:37<22:32,  2.46s/it]generating responses:  21%|██        | 144/681 [05:13<23:23,  2.61s/it]generating responses:  23%|██▎       | 156/681 [05:46<23:18,  2.66s/it]generating responses:  25%|██▍       | 168/681 [06:16<22:16,  2.61s/it]generating responses:  26%|██▋       | 180/681 [06:38<19:47,  2.37s/it]generating responses:  28%|██▊       | 192/681 [07:00<18:03,  2.22s/it]generating responses:  28%|██▊       | 192/681 [07:23<18:48,  2.31s/it]
Traceback (most recent call last):
  File "get_results_base_model.py", line 61, in <module>
    postprocessor.add_responses_column(model=model, 
  File "/extra/ferrazzi/llm/mistral_finetuning/utils/test_data_processor.py", line 176, in add_responses_column
    tmp = self._generate_model_response(self.test_data.select(indici), model, tokenizer, max_new_tokens_factor)
  File "/extra/ferrazzi/llm/mistral_finetuning/utils/test_data_processor.py", line 152, in _generate_model_response
    generated_ids = model.generate(**model_inputs, do_sample=True, max_new_tokens=max_new_tokens,  pad_token_id=tokenizer.eos_token_id) # max_new_tokens=max_new_tokens,
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/transformers/generation/utils.py", line 1592, in generate
    return self.sample(
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/transformers/generation/utils.py", line 2696, in sample
    outputs = self(
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/transformers/models/llama/modeling_llama.py", line 1168, in forward
    outputs = self.model(
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/transformers/models/llama/modeling_llama.py", line 982, in forward
    causal_mask = self._update_causal_mask(attention_mask, inputs_embeds)
  File "/home/ferrazzi/.conda/envs/gpu_venv_lates/lib/python3.8/site-packages/transformers/models/llama/modeling_llama.py", line 1063, in _update_causal_mask
    self.causal_mask[None, None, :, :].repeat(batch_size, 1, 1, 1).to(dtype) * torch.finfo(dtype).min
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.50 GiB (GPU 0; 23.69 GiB total capacity; 13.28 GiB already allocated; 81.69 MiB free; 22.49 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
